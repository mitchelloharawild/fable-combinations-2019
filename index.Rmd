---
title: "fable::ISF2019"
subtitle: "Flexible futures for fable functionality"
author: "Mitchell O'Hara-Wild"
date: '12/05/2019'
output:
  xaringan::moon_reader:
    chakra: libs/remark-latest.min.js
    css: ["libs/slides.css",  "libs/animate.css"]
    lib_dir: libs
    seal: false
    nature:
      highlightStyle: github
      ratio: '16:9'
      highlightLines: true
      countIncrementalSlides: false
      beforeInit: ["libs/jquery/jquery.min.js", "libs/slides.js"]
---
class: inverse

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE, width = 120)

library(tidyverse)
library(knitr)
library(kableExtra)
library(fontawesome)
library(lubridate)
library(htmltools)

library(tsibble)
library(fasster)
library(fable)

opts_chunk$set(
  echo = FALSE, warning = FALSE, message = FALSE, comment = "#>",
  fig.path = 'figure/', cache.path = 'cache/', fig.align = 'center',
  fig.width = 12, fig.height = 4, fig.show = 'hold',
  cache = TRUE, external = TRUE, dev = 'svglite', dev.args = list(bg = "transparent")
)

mp4_vid <- function(src){
  HTML(
    paste0(
      '<video autoplay>
        <source src="', src, '" type="video/mp4">
      </video>'
    )
  )
}

hook_output <- knit_hooks$get("output")
knit_hooks$set(output = function(x, options) {
   lines <- options$output.lines
   if (is.null(lines)) {
     return(hook_output(x, options))  # pass to default hook
   }
   x <- unlist(strsplit(x, "\n"))
   more <- "..."
   if (length(lines)==1) {        # first n lines
     if (length(x) > lines) {
       # truncate the output, but add ....
       x <- c(head(x, lines), more)
     }
   } else {
     x <- c(more, x[lines], more)
   }
   # paste these lines together
   x <- paste(c(x, ""), collapse = "\n")
   hook_output(x, options)
 })

theme_set(
  theme_grey(base_size = 16) +
  theme(
    legend.position = "bottom",
    plot.background = element_rect(fill = "transparent"),
    legend.background = element_rect(fill = "transparent")
  )
)
```

.title[fable]
.sticker-float[![fable](resources/fable.svg)]

## Flexible futures for fable functionality

.bottom[
### Mitchell O'Hara-Wild (`r fa("twitter", fill="#1da1f2")`[@mitchoharawild](https://twitter.com/mitchoharawild))
### Rob Hyndman (`r fa("twitter", fill="#1da1f2")`[@robjhyndman](https://twitter.com/robjhyndman/))
### 19 June 2019
### Slides @ [mitchelloharawild.com/isf2019](https://mitchelloharawild.com/isf2019)
]

---
class: center

.animated.fadeIn[
## Forecasting in the tidyverse
]

.sticker[![tsibbledata](resources/tsibbledata.svg)]
.sticker[![feasts](resources/feasts.svg)]
.sticker[![tsibble](resources/tsibble.svg)]

--

.sticker[![fable](resources/fable.svg)]

???

Outline talk structure, a bit on tsibble, mostly about fable, and a bit on feasts

---

class: top

.sticker-float[![tsibble](resources/tsibble.svg)]

# Domestic tourism in Australia

### The tsibble data structure

```{r tourism-data, echo = TRUE}
library(tsibble)
tourism
```

---

class: top

.sticker-float[![feasts](resources/feasts.svg)]

# Domestic tourism in Australia

### A peak at the features

```{r tourism-features, echo = TRUE}
library(feasts)
tourism_features <- tourism %>% 
  features(Trips, feature_set(tags = "stl"))
```

```{r tourism-features-print, echo = FALSE}
tourism_features
```


---

class: top

.sticker-float[![ggplot2](resources/ggplot2.svg)]

# Domestic tourism in Australia

### A peak at the features

```{r tourism-features-plot, echo = TRUE}
library(ggplot2)
tourism_features %>% 
  ggplot(aes(x = trend_strength, y = seasonal_strength_year, colour = Purpose)) + 
  geom_point() + stat_density_2d(aes(fill = Purpose, alpha = ..level..), bins = 3, geom = "polygon")
```

---

class: top

.sticker-float[![tsibble](resources/tsibble.svg)].sticker-float[![dplyr](resources/dplyr.svg)]

# Domestic tourism in Australia

### Compute quarterly trips across Australia

```{r tourism-total, echo = TRUE, fig.show='hide'}
library(dplyr)
tourism_aus <- tourism %>% 
  summarise(Trips = sum(Trips))

tourism_aus %>% 
  autoplot(Trips)
```


.flex-row[
```{r tourism-total-print, echo = FALSE}
tourism_aus
```
.full-width[
```{r tourism-total-plot, echo = FALSE}
tourism_aus %>% 
  autoplot(Trips)
```
]
]
---

class: inverse, top

.sticker-float[![fable](resources/fable.svg)]

.title[Thanks! `r fa("comments", fill = "white")`]

<br>

.larger[
`r fa("github", fill = "white")` Learn more on GitHub: [tidyverts/fable](https://github.com/tidyverts/fable)

`r fa("chart-line", fill = "white")` Keep updated: [tidyverts.org](http://www.tidyverts.org)

`r fa("desktop", fill = "white")` Review slides: [mitchelloharawild.com/isf2019](https://mitchelloharawild.com/isf2019)

<br>

.footnote[This work is licensed as `r fa("creative-commons", fill="white")` BY-NC 4.0.]
]
